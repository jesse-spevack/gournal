<%# Bullet journal style habit list %>
<div data-controller="inline-habit-editor" data-target-year="<%= @target_year || Date.current.year %>" data-target-month="<%= @target_month || Date.current.month %>">
  <ul class="habit-list">
    <% @habits.each do |habit| %>
      <li class="habit-item" data-habit-id="<%= habit.id %>">
        <span class="bullet">â€¢</span>
        <span class="habit-name" 
              data-inline-habit-editor-target="name"
              data-action="click->inline-habit-editor#edit"
              data-habit-id="<%= habit.id %>">
          <%= habit.name %>
        </span>
      </li>
    <% end %>
  </ul>
  
  <%# New habit form %>
  <div class="habit-item habit-item--new">
    <span class="bullet">â€¢</span>
    <%= form_with url: habits_path, 
                  method: :post,
                  data: { 
                    inline_habit_editor_target: "newForm",
                    action: "submit->inline-habit-editor#createHabit"
                  },
                  class: "new-habit-form" do |form| %>
      <% if defined?(@year_month) && @year_month.present? %>
        <%= form.hidden_field :year_month, value: @year_month %>
      <% end %>
      <%= form.text_field :name, 
                          placeholder: "Add new habit", 
                          class: "habit-input habit-input--new",
                          data: { 
                            inline_habit_editor_target: "newInput",
                            action: "blur->inline-habit-editor#createHabit keydown.esc->inline-habit-editor#cancelNew"
                          } %>
    <% end %>
  </div>
</div>